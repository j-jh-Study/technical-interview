# TCP,UDP

TCP(Transmission Control Protocol)와 UDP(User Datagram Protocol)는 둘 다 인터넷 프로토콜 스택에서 사용되는 전송 계층 프로토콜입니다. 둘 다 데이터 패킷을 보내고 받으며, 인터넷에서 데이터 전송에 사용됩니다. 하지만 이 두 프로토콜은 몇 가지 중요한 차이점이 있습니다.

- 연결 지향성
  - TCP는 연결 지향적입니다. 이것은 데이터를 보내기 전에 송신측과 수신측 간에 먼저 연결을 설정해야 한다는 것을 의미합니다. 이에 대비해 UDP는 비연결 지향적입니다. 데이터를 보내기 위해서는 연결 설정 단계가 필요하지 않습니다.

- 신뢰성
  - TCP는 신뢰성 있는 전송을 보장합니다. 이것은 데이터가 전송될 때 패킷 손실이나 에러가 발생하면 재전송을 시도한다는 것을 의미합니다. 반면 UDP는 전송 신뢰성이 보장되지 않습니다. 패킷이 손실되거나 에러가 발생하면 재전송을 하지 않고 그냥 무시합니다.

- 속도
  - UDP는 TCP보다 더 빠릅니다. TCP는 데이터 전송이 보장되는 신뢰성 있는 전송을 위해 많은 오버헤드를 갖기 때문입니다. UDP는 그렇지 않기 때문에 더 빠르게 데이터를 전송할 수 있습니다.

- 헤더
  - TCP 헤더는 20바이트의 크기입니다. 반면 UDP 헤더는 8바이트의 크기입니다. 이는 UDP가 TCP보다 더 작은 헤더를 가지므로 오버헤드가 적다는 것을 의미합니다.

- 사용 사례
  - TCP는 일반적으로 파일 전송, 이메일, 웹 페이지 등과 같은 신뢰성이 중요한 데이터 전송에 사용됩니다. UDP는 게임, 실시간 스트리밍, DNS 등과 같이 신속한 전송이 더 중요한 경우에 사용됩니다.

요약하자면, TCP는 신뢰성이 높은 연결 지향적인 프로토콜이고, UDP는 전송 속도가 빠른 비연결 지향적인 프로토콜입니다. 어떤 프로토콜을 사용할지는 데이터 전송의 용도와 상황에 따라 결정되어야 합니다.

***

### 추가 3-way hadshake

TCP 3-way handshake(삼상 연결 설정)는 TCP 프로토콜을 사용하여 연결을 설정할 때 사용하는 과정입니다. 이 과정은 다음과 같이 이루어집니다.

1. 클라이언트는 서버에 SYN 패킷을 보냅니다. 이 패킷에는 클라이언트가 사용할 임의의 숫자인 시퀀스 번호(SYN 번호)가 포함됩니다.

2. 서버는 클라이언트에게 SYN/ACK 패킷을 보냅니다. 이 패킷에는 서버가 사용할 임의의 숫자인 시퀀스 번호(SYN 번호)와 클라이언트의 시퀀스 번호에 1을 더한 값인 확인 번호(ACK 번호)가 포함됩니다.

3. 클라이언트는 서버에게 ACK 패킷을 보냅니다. 이 패킷에는 서버의 시퀀스 번호에 1을 더한 값인 확인 번호(ACK 번호)가 포함됩니다.

이렇게 3번의 패킷 교환 과정을 거치면 연결이 설정됩니다. 이 과정에서는 시퀀스 번호와 확인 번호를 사용하여 패킷의 순서를 확인하고 손실된 패킷을 재전송합니다. 이를 통해 데이터 전송의 신뢰성이 보장됩니다.

*** 

### 4-way hadshake

TCP에서는 연결을 끝낼 때 "4-way handshake(사상 연결 해제)"이라는 과정을 사용합니다. 이 과정은 다음과 같이 이루어집니다.

1. 클라이언트가 서버에게 FIN 패킷을 보냅니다.

2. 서버는 FIN 패킷을 받고, ACK 패킷을 보내면서 클라이언트로부터 더 이상의 데이터 전송이 없다는 것을 알립니다.

3. 서버가 데이터 전송이 완료되면, 자신도 FIN 패킷을 보내고, 클라이언트로부터 FIN/ACK 패킷을 받으면서 클라이언트에게 더 이상의 데이터 전송이 없다는 것을 알립니다.

4. 클라이언트는 서버로부터 FIN 패킷을 받으면서 ACK 패킷을 보내고, 이로써 연결이 완전히 종료됩니다.

***

### 그외 TCP 관련 키워드들

- 2-way handshake: TCP가 아닌 다른 프로토콜에서 사용되는 개념입니다. 클라이언트가 서버에게 요청을 보내면, 서버는 요청을 받았다는 ACK 패킷을 보내고, 동시에 응답을 보내는 방식입니다. 이 과정에서 SYN 패킷이나 SYN/ACK 패킷이 사용되지 않습니다.

- Zero-window probing: TCP에서 윈도우 크기가 0일 때, 송신측은 일정 시간 후에 수신측에게 ACK 패킷을 보내서 윈도우 크기를 조정하도록 유도하는 과정입니다.

- Fast retransmit: TCP에서 패킷 손실을 감지할 때, 3-way handshake 과정을 반복해서 수행하지 않고, 수신측이 마지막으로 받은 ACK 패킷의 번호를 확인하여 재전송하는 방식입니다.

- Slow start: TCP에서 데이터 전송 속도를 조절하는 방식 중 하나입니다. 데이터 전송을 시작할 때는 전송할 수 있는 패킷의 개수를 점점 늘려가며, 네트워크 혼잡 상황에 따라 전송 속도를 조절합니다. 이 과정에서 초기에 전송되는 패킷 수는 작기 때문에, 처음 몇 번의 패킷 전송 과정이 3-way handshake와 유사합니다.

---

  - Window size (윈도우 크기): TCP에서 데이터를 전송할 때, 수신측이 한번에 처리할 수 있는 데이터의 양을 의미합니다. 송신측은 이 윈도우 크기를 이용하여 데이터 전송을 제어합니다.

  - Congestion control (혼잡 제어): TCP는 혼잡 제어 기능을 내장하고 있어서, 네트워크 내에 혼잡이 발생하는 것을 방지합니다. 혼잡이 발생하면 송신측은 데이터 전송을 줄이고, 수신측은 ACK 패킷을 빠르게 보내서 송신측이 데이터 전송을 조절하도록 합니다.

  - Retransmission (재전송): TCP는 데이터 전송 중에 패킷이 손실되거나 손상되는 경우, 재전송을 통해 데이터의 신뢰성을 보장합니다.

  - Flow control (흐름 제어): TCP는 데이터 전송 속도를 수신측의 처리 속도에 맞추어 제어함으로써, 수신측이 데이터를 처리할 수 없는 경우를 방지합니다.

  - Port number (포트 번호): TCP는 포트 번호를 사용하여 다양한 애플리케이션에서 데이터를 식별합니다. 예를 들어, 웹 브라우저에서는 80번 포트를 사용하고, SSH는 22번 포트를 사용합니다.

  - MSS (Maximum Segment Size): TCP에서 한번에 전송할 수 있는 최대 데이터 양을 의미합니다. 이 값은 수신측과 송신측 중 작은 값으로 결정됩니다.

  - Nagle's algorithm: 작은 데이터를 여러번 보내는 것보다 하나의 큰 데이터를 보내는 것이 더 효율적이라는 가정에서 만들어진 알고리즘입니다. 작은 데이터를 모아서 전송하므로, 데이터 전송량을 줄일 수 있습니다.
